Skip to content
You said:
so i want to create a form hat isunder my page. I have a table in supabase and index.html file in getHub. The form works but i want it to show the email and name and comment field and only the name and the comment to appear under the form and people to be able to comment on each other's post. here is the code for the index.html file: <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Comments Widget</title>

  <style>
    body {
      font-family: serif;
      max-width: 700px;
      margin: 2em auto;
    }
    .comment {
      margin-bottom: 1em;
      padding-left: 1em;
      border-left: 1px solid #ccc;
    }
    textarea {
      width: 100%;
      height: 80px;
    }
    button {
      margin-top: 0.5em;
    }
  </style>

  <!-- Load Supabase FIRST -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>

<h3>Comments</h3>
<div id="comments"></div>

<h4>Leave a comment</h4>
<input id="name" placeholder="Name (optional)"><br><br>
<textarea id="content" placeholder="Your comment"></textarea><br>
<button id="postBtn">Post Comment</button>

<script>
/* ================================
   Supabase initialization
   ================================ */

const sb = supabase.createClient(
  'https://pidzgdrdgqgsayfoxqba.supabase.co',
  'sb_publishable_-rGnPqFMdXSVXmKdI2bCow_R7uuC53z'
);

/* ================================
   Post comment
   ================================ */
async function postComment() {
  const name = document.getElementById('name').value || null;
  const content = document.getElementById('content').value.trim();

  if (!content) {
    alert('Please write a comment.');
    return;
  }

  const { error } = await sb.from('comments').insert({
    name: name,
    content: content,
    page: 'life-and-death-in-gaza'
  });

  if (error) {
    console.error(error);
    alert('Error posting comment');
    return;
  }

  document.getElementById('name').value = '';
  document.getElementById('content').value = '';

  loadComments();
}

/* ================================
   Load comments
   ================================ */
async function loadComments() {
  const { data, error } = await sb
    .from('comments')
    .select('*')
    .eq('page', 'life-and-death-in-gaza')
    .order('created_at', { ascending: true });

  if (error) {
    console.error(error);
    return;
  }

  const container = document.getElementById('comments');
  container.innerHTML = '';

  data.forEach(c => {
    const div = document.createElement('div');
    div.className = 'comment';
    div.innerHTML = <strong>${c.name || 'Anonymous'}</strong><br>${c.content};
    container.appendChild(div);
  });
}

/* ================================
   Event wiring
   ================================ */
document.getElementById('postBtn').addEventListener('click', postComment);

/* ================================
   Initial load
   ================================ */
loadComments();
</script>

</body>
</html>
ChatGPT said:
To modify your existing code so that the comments display only the name and comment below the form, and allow people to comment on each other's posts, you can make a few updates. Specifically, you’ll need to:

Display only the name and comment – You're already doing this, but the name field is optional. If it's empty, you can display a placeholder like "Anonymous" to avoid showing a blank name.

Show comment under the form – Ensure the comment section updates dynamically after posting, and only the relevant fields (name and comment) appear, excluding the email or any other fields.

Allow commenting on each other's posts – Each comment should be listed in the comments section, and users should be able to post comments on any existing posts.

Here’s the updated version of your code with these considerations:

Updated Code:
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Comments Widget</title>

  <style>
    body {
      font-family: serif;
      max-width: 700px;
      margin: 2em auto;
    }
    .comment {
      margin-bottom: 1em;
      padding-left: 1em;
      border-left: 1px solid #ccc;
    }
    textarea {
      width: 100%;
      height: 80px;
    }
    button {
      margin-top: 0.5em;
    }
  </style>

  <!-- Load Supabase FIRST -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>

<h3>Comments</h3>
<div id="comments"></div>

<h4>Leave a comment</h4>
<input id="name" placeholder="Name (optional)"><br><br>
<textarea id="content" placeholder="Your comment"></textarea><br>
<button id="postBtn">Post Comment</button>

<script>
/* ================================
   Supabase initialization
   ================================ */

const sb = supabase.createClient(
  'https://pidzgdrdgqgsayfoxqba.supabase.co',
  'sb_publishable_-rGnPqFMdXSVXmKdI2bCow_R7uuC53z'
);

/* ================================
   Post comment
   ================================ */
async function postComment() {
  const name = document.getElementById('name').value || null;
  const content = document.getElementById('content').value.trim();

  if (!content) {
    alert('Please write a comment.');
    return;
  }

  const { error } = await sb.from('comments').insert({
    name: name,
    content: content,
    page: 'life-and-death-in-gaza'
  });

  if (error) {
    console.error(error);
    alert('Error posting comment');
    return;
  }

  document.getElementById('name').value = '';
  document.getElementById('content').value = '';

  loadComments(); // Reload comments after posting
}

/* ================================
   Load comments
   ================================ */
async function loadComments() {
  const { data, error } = await sb
    .from('comments')
    .select('*')
    .eq('page', 'life-and-death-in-gaza')
    .order('created_at', { ascending: true });

  if (error) {
    console.error(error);
    return;
  }

  const container = document.getElementById('comments');
  container.innerHTML = ''; // Clear the existing comments before reloading

  data.forEach(c => {
    const div = document.createElement('div');
    div.className = 'comment';
    // Use a fallback name if the comment's name is null or empty
    const commenterName = c.name ? c.name : 'Anonymous';
    div.innerHTML = `<strong>${commenterName}</strong><br>${c.content}`;
    container.appendChild(div);
  });
}

/* ================================
   Event wiring
   ================================ */
document.getElementById('postBtn').addEventListener('click', postComment);

/* ================================
   Initial load
   ================================ */
loadComments();
</script>

</body>
</html>
Explanation of Changes:
Name Field Fallback:

The code checks if c.name is null or empty and defaults to "Anonymous" if it is, ensuring that the name field is never left blank.

Dynamic Loading of Comments:

After a new comment is posted (loadComments() is called), the comment list is cleared and then dynamically populated with the latest comments, showing only the name and the comment itself.

Displaying Comments:

The comments are displayed under the form, with each comment showing the name (or "Anonymous") and the comment content.

Additional Considerations:
You might want to handle additional features like comment deletion or replies, which can be done by modifying your Supabase table structure or adding buttons to each comment.

Ensure your Supabase table (comments) has the following columns:

name (optional): for the commenter's name

content: for the comment text

page: to distinguish which page the comments belong to (e.g., 'life-and-death-in-gaza')

This should give you a functional commenting system where people can comment, view other comments, and the UI is clean with only the necessary details being shown.




Attach

Search

Study

Create image

Voice
No file chosenNo file chosen
ChatGPT can make mistakes. Check important info.
